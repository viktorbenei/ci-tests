---
format_version: 1.0.0
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git

app:
  envs:
  - BITRISE_PROJECT_PATH: "./BitriseXcode7Sample.xcodeproj"
  - BITRISE_SCHEME: BitriseXcode7Sample

trigger_map:
- pattern: "*"
  is_pull_request_allowed: true
  workflow: primary

workflows:
  primary:
    steps:
    - script:
        title: Quick tests
        inputs:
        - content: |-
            #!/bin/bash
            set -ex
            env
    - git-clone:
        run_if: enveq "BITRISE_IO" "true"
    - certificate-and-profile-installer:
        run_if: enveq "BITRISE_IO" "true"
    - xcode-test:
        title: 'Xcode: Unit Test'
        inputs:
        - simulator_device: iPhone 6
          opts:
            is_expand: false
        - is_clean_build: 'yes'
    - xcode-test:
        title: 'Xcode: Unit Test'
        inputs:
        - simulator_device: iPhone 5s
          opts:
            is_expand: false
        - is_clean_build: 'no'
    envs:
  master:
    steps:
    - script:
        title: Quick tests
        inputs:
        - content: |-
            #!/bin/bash
            set -ex
            env
    - git-clone:
    - certificate-and-profile-installer: {}
    - xcode-test:
        title: 'Xcode: Unit Test'
        inputs:
        - simulator_device: iPhone 6
          opts:
            is_expand: false
        - is_clean_build: 'no'
    - xcode-archive: {}
    - bitrise-ios-deploy: {}
    envs:
